# v0.1.0-alpha.6.x Remediation Backlog: Build Contract and Docs-Truth Reconciliation

Status: Draft for execution  
Date: 2026-02-13  
Scope: Build contracts, feature/profile coherency, release-note/doc alignment, CI gate coverage  
In scope crates/docs: workspace root, `swarm-torch*` crates, `docs/release_notes/*`, `SWARM_TORCH_TECHNICAL_WHITE_PAPER_v0.1.md`, `ADRs.md`, `SECURITY.md`, `readme.md`  
Out of scope: new transport implementations, new ML algorithms, UI/server work

## Why This File Exists

The A6X feature backlog tracks forward delivery. This file tracks cross-cutting remediation discovered by deep audit:

1. Build contract drift (MSRV/feature/profile gaps)  
2. Doc truth drift (code vs claims mismatch)  
3. Release-note chain integrity drift

This backlog is intentionally separate so production-hardening debt does not get buried under feature delivery.

## Decision Framework: Change Code vs Change Docs

Use this decision table for every drift item before patching:

| Condition | Preferred action | Rationale |
|---|---|---|
| Code behavior is correct, tested, and aligned with ADR intent; docs stale | Update docs | Preserve stable implementation and reduce doc drift quickly |
| Docs claim accepted roadmap capability but code is stub/placeholder | Update docs to `Planned`/`Partial` unless implementation is already scheduled in this sprint | Avoid shipping false capability claims |
| Code violates explicit contract (`rust-version`, feature contract, fail-closed security rule) | Fix code/build config first, then docs | Contract violations are release blockers |
| Ambiguous historical examples conflict with current normative sections | Annotate as historical + add canonical pointer | Preserve history without misleading current contributors |
| Fix would cause API/wire break and no migration path exists | Prefer docs clarification + planned migration slice | Avoid uncontrolled breakage in alpha consumers |

## Cross-Cutting Invariants (Must Hold After Remediation)

1. Workspace build contracts are explicit and truthful (MSRV and feature/profile expectations are enforceable).  
2. `readme.md`, whitepaper, ADR canon, and release notes do not claim implemented behavior that is currently placeholder/stub.  
3. Historical docs remain available but are clearly non-normative.  
4. Security and replay/auth language remains fail-closed and consistent with implementation.  
5. Every remediation slice includes objective gates and tests/commands that prove closure.

## Prioritized Findings to Remediate

### High severity

1. Workspace `rust-version = 1.75` contract is not true for full workspace build path (transitive dependency constraints in model/backend stack).  
2. `swarm-torch --no-default-features` path is broken due to unconditional std-only report binary.  
3. `swarm-torch-core --no-default-features` path is broken (aggregation interfaces reference alloc-only types/fields unconditionally).

### Medium severity

4. Runtime embassy feature path is not MSRV-clean.  
5. README and crate docs overclaim transport/runtime/API maturity (examples do not match public API).  
6. Whitepaper appendix conformance rows still mark some implemented unsafe-reason behavior as planned.  
7. Missing M4-01 release-note artifact creates audit-chain hole.

### Low severity

8. `SECURITY.md` wording still says CI is not added though CI exists.  
9. Historical ADR snippets can mislead on envelope sender/signature shape unless explicitly marked superseded.

## Remediation Slices

| ID | Slice | Files (primary) | Definition of done |
|---|---|---|---|
| R1 | Build contract truth: workspace MSRV policy and gating | `Cargo.toml`, `.github/workflows/rust.yml`, `swarm-torch-models/Cargo.toml`, docs | `rust-version` claim and CI gates match reality; either full workspace 1.75 passes or policy narrows with explicit docs + gates |
| R2 | no-default-features profile coherency | `swarm-torch/src/bin/swarm_torch_report.rs`, `swarm-torch/Cargo.toml`, `swarm-torch-core/src/aggregation.rs`, `swarm-torch-core/src/traits.rs` | no-default profiles are either build-clean or explicitly unsupported with enforced gating/docs |
| R3 | Runtime/embedded profile policy clarification | `swarm-torch-runtime/Cargo.toml`, runtime docs, whitepaper/readme | Embassy/MSRV expectations stated precisely; profile status is verifiable |
| R4 | Doc truth-sync for API/transport maturity | `readme.md`, `swarm-torch/src/lib.rs` docs, `swarm-torch-net/src/lib.rs`, whitepaper sections | All public docs match current implemented surface and roadmap status |
| R5 | Release-note and canon chain integrity | `docs/release_notes/*`, `docs/release_notes/README.md`, `ADRs.md`, `SECURITY.md` | Missing links closed; historical/superseded sections annotated; CI/security wording current |

## R1: Build Contract Truth (PRD-Style)

### Problem

The repo advertises workspace MSRV `1.75`, but full workspace MSRV build is not currently true.

### Requirements

1. MUST define one explicit MSRV contract:
   - Option A: workspace-wide `1.75`, or
   - Option B: per-crate MSRV floors with documented exceptions.
2. MUST enforce the chosen contract in CI.
3. MUST update docs (whitepaper/security/readme) to reflect chosen contract.

### Implementation Plan

1. Decide contract:
   - `Contract-A` (strict): make full workspace build on 1.75 pass by constraining dependencies/features.
   - `Contract-B` (tiered): keep workspace at stable, declare crate-level MSRV for core security path and runtime profiles.
2. If `Contract-B`, set policy in root docs:
   - core/security path remains 1.75-gated
   - model/backends may require higher compiler floor.
3. CI matrix updates:
   - add explicit job names for each contract target (not ambiguous generic build).
4. Add command proofs in release notes for remediation slice.

### Invariants

1. No doc claims a lower MSRV than enforced by CI for that target scope.
2. Commands in docs are copy-paste valid for stated scope.

### Verification Gates

```bash
cargo +1.75 build -p swarm-torch-core --no-default-features --features alloc
cargo +1.75 build -p swarm-torch-net --no-default-features
# plus whatever target(s) contract declares for workspace-level MSRV
```

## R2: no-default-features Profile Coherency (PRD-Style)

### Problem

`no-default-features` paths currently include broken combinations and unclear support boundaries.

### Requirements

1. MUST either support or explicitly disallow each published no-default profile.
2. MUST not let std-only binaries compile in non-std profile unless gated.
3. MUST keep fail-closed/security-critical crates buildable on declared minimal profiles.

### Implementation Plan

1. `swarm-torch` report binary:
   - gate binary with `required-features = ["std"]` or cfg-gate main path.
2. `swarm-torch-core` no-alloc strategy:
   - either:
     - implement alloc-free trait signatures/feature-gated APIs, or
     - formally scope out `--no-default-features` for core aggregation and document as unsupported.
3. Update CI with profile-specific build checks reflecting support matrix.

### Invariants

1. Every profile shown in docs has at least one CI/build gate.  
2. Unsupported profiles fail fast with explicit rationale in docs (not accidental compiler errors).

### Verification Gates

```bash
cargo build -p swarm-torch --no-default-features
cargo +1.75 build -p swarm-torch-core --no-default-features
cargo +1.75 build -p swarm-torch-core --no-default-features --features alloc
```

## R3: Runtime/Embedded Policy Clarification (PRD-Style)

### Problem

Embassy path and embedded messaging in docs are broader than currently validated build/test posture.

### Requirements

1. MUST classify runtime support as `Implemented`, `Partial`, or `Planned` with explicit evidence.
2. MUST reconcile compiler/version constraints for embassy path.
3. SHOULD avoid broad embedded claims until profile gates exist.

### Implementation Plan

1. Document runtime support matrix:
   - Tokio: implemented
   - Embassy: placeholder/partial with compiler constraints
2. If needed, pin/update embassy deps or adjust MSRV policy wording.
3. Add minimally-scoped CI/doc commands for embassy profile (or mark as not CI-gated yet).

### Invariants

1. Runtime status table in docs matches actual compiled/tested profiles.

### Verification Gates

```bash
cargo build -p swarm-torch-runtime --features tokio
cargo build -p swarm-torch-runtime --no-default-features --features embassy
```

## R4: Doc Truth-Sync for API and Transport Maturity

### Problem

Public docs (especially README and crate-level docs) currently include examples and capability claims beyond current API/implementation.

### Requirements

1. MUST ensure all quick-start examples compile against current public API, or clearly mark as roadmap pseudocode.
2. MUST mark transport implementations as placeholder where applicable.
3. MUST align robust aggregation claims with actually implemented variants.

### Implementation Plan

1. `readme.md`:
   - replace/annotate non-compiling `.transport(...).train(...)` snippets
   - align roadmap checkmarks with implemented modules
   - align robust aggregator table with code reality.
2. `swarm-torch-net/src/lib.rs` docs:
   - change “provides TCP/UDP/BLE/LoRa/WiFi implementations” to “trait + mock + placeholders”.
3. `swarm-torch/src/lib.rs` crate docs:
   - update quick start to match existing builder capabilities.
4. Whitepaper appendix rows:
   - flip implemented unsafe-reason related rows from planned to implemented where evidenced.

### Invariants

1. Any code snippet in docs is either compile-valid or explicitly tagged pseudocode/roadmap.  
2. No section claims implemented real transports unless modules exist and are wired.

### Verification Gates

```bash
cargo test --workspace
cargo doc --workspace --no-deps
rg -n "TCP/UDP transports with Tokio runtime|\\.train\\(|\\.transport\\(" readme.md swarm-torch/src/lib.rs swarm-torch-net/src/lib.rs
```

## R5: Release-Note and Canon Chain Integrity

### Problem

The release narrative has at least one missing artifact and some canon wording drift.

### Requirements

1. MUST restore or recreate missing release-note artifacts referenced by subsequent milestones.
2. MUST keep release-note index complete and chronological.
3. MUST keep canon docs explicit on what is historical/superseded.

### Implementation Plan

1. Add `docs/release_notes/M4-01_ed25519_signatures.md`:
   - either restore from history or reconstruct from code/commit evidence.
2. Update `docs/release_notes/README.md` ordering to include M4-01.
3. `ADRs.md`:
   - annotate older envelope snippets as historical; point to ADR-0008B as current contract.
4. `SECURITY.md`:
   - reword CI section from “once CI is added” to “CI exists; selected gates pending”.

### Invariants

1. Every “builds on X” release note has corresponding file in tree/index.  
2. Historical examples cannot be mistaken for normative current interfaces.

### Verification Gates

```bash
rg -n "Builds on: M4-01|M4-01" docs/release_notes -g '*.md'
ls docs/release_notes
rg -n "Historical|Superseded|ADR-0008B" ADRs.md
```

## Sequencing and Dependencies

1. R1 first (contract baseline)  
2. R2 second (profile correctness)  
3. R3 third (runtime/embedded policy lock)  
4. R4 fourth (doc/API truth-sync)  
5. R5 fifth (release-note/canon closure)

Reasoning:
- R1/R2 define what is actually supportable.
- R3-R5 then align narrative to locked technical truth.

## Execution Notes (2026-02-13, Pass 1)

Decisions locked during first remediation pass:

1. `R1` selected `Contract-B` (tiered MSRV):
   - `swarm-torch-core` and security-critical replay/auth paths remain MSRV-gated at 1.75.
   - `swarm-torch-models` and `swarm-torch` now declare higher MSRV (`1.81`) to reflect backend dependency reality.
2. `R2` selected explicit support boundary:
   - `swarm-torch` crate is now fail-fast std-only (`compile_error!` when `std` is disabled).
   - `swarm-torch-core --no-default-features` now compiles (aggregation module is alloc-gated).
3. CI lock-in added:
   - Added `Build (MSRV core no_std minimal)` gate to prevent regression of no-alloc core compilation.

Follow-up required in `R3`-`R5`:

1. Canonical docs still need explicit wording updates for tiered MSRV and std-only `swarm-torch` crate boundary.
2. README/API maturity and transport status remain to be reconciled against current implementation.

Updates landed in subsequent pass:

1. `R3`/`R4` partial closure:
   - `readme.md`, `swarm-torch/src/lib.rs`, and `swarm-torch-net/src/lib.rs` now explicitly describe current std/no_std and transport maturity boundaries.
   - Whitepaper matrix/gates updated for implemented unsafe-reason marking and current embedded/build posture.
2. `R5` partial closure:
   - Missing `M4-01` release note added and indexed.
   - Historical ADR envelope snippets now carry explicit supersession notes pointing to ADR-0008B.
   - `SECURITY.md` CI wording corrected to reflect that CI exists today.

## Commit Boundaries (Recommended)

1. `remediation(build): align MSRV/feature contract and CI gates` (R1+R2)
2. `docs(runtime): clarify embedded/runtime profile support` (R3)
3. `docs(api): reconcile README/crate docs with implemented transport/API surface` (R4)
4. `docs(release): restore M4-01 note and canon integrity annotations` (R5)

## Risk Register

1. Tightening MSRV/feature policy can break downstream expectations.
   - Mitigation: document policy change in release notes with explicit compatibility notes.
2. Over-correcting docs to “planned” can undersell implemented paths.
   - Mitigation: evidence-based line-by-line updates, not broad rewrites.
3. Fixing no-default/no-alloc paths may require API shape decisions.
   - Mitigation: ADR note if public API semantics change.

## Research Tasks Before Patching (Rigor Pass)

1. Reconstruct dependency MSRV floor per crate path (`cargo tree -i` + lockfile review).  
2. Evaluate whether core no-alloc profile should be:
   - supported with scoped API, or
   - explicitly unsupported until dedicated sprint.
3. Confirm external docs claims (README + whitepaper) are grounded in current testable commands.
4. Recover M4-01 details from git history for precise, non-fiction release note reconstruction.

## Completion Criteria for This Remediation Backlog

1. All five slices are closed with merged evidence (tests/build/docs).  
2. No remaining high-severity contract mismatch between code and canonical docs.  
3. CI and local conformance commands are synchronized with documented support matrix.  
4. Release-note timeline is complete and self-consistent.
